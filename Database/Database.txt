CREATE DATABASE BookingSystem;

USE BookingSystem;

-- Create the base table for RentableEntity
CREATE TABLE Rentables (
    RentableId INT PRIMARY KEY IDENTITY(1,1),
    Name NVARCHAR(100) NOT NULL,
    Description NVARCHAR(500) NULL,
    CostUsagePerDay DECIMAL(18,2) NOT NULL,
    IsDeleted BIT NOT NULL DEFAULT 0
)

-- Create the table for Vehicles
CREATE TABLE Vehicles (
    RentableId INT,
    VehicleId INT PRIMARY KEY IDENTITY(1,1),
    Brand NVARCHAR(50) NOT NULL,
    Model NVARCHAR(50) NOT NULL,
    PassengerCapacity INT NOT NULL,
    SerialNumber NVARCHAR(50) NOT NULL,
    CONSTRAINT FK_Vehicles_Rentables FOREIGN KEY (RentableId) 
        REFERENCES Rentables(RentableId)
)

-- Create the table for Properties
CREATE TABLE Properties (
    RentableId INT,
    PropertyId INT PRIMARY KEY IDENTITY(1,1),
    Location NVARCHAR(200) NOT NULL,
    CONSTRAINT FK_Properties_Rentables FOREIGN KEY (RentableId) 
        REFERENCES Rentables(RentableId)
)

CREATE TABLE Bookings (
    BookingId INT PRIMARY KEY IDENTITY(1,1),
    RentableId INT NOT NULL,
    InitBooking DATE NOT NULL,
    EndBooking DATE NOT NULL,
    DaysBooked INT NOT NULL,
    PaymentMethod NVARCHAR(100) NOT NULL, -- Relación con PaymentMethods
    TotalPrice DECIMAL(18,2) NOT NULL, -- Precio total con recargo o descuento aplicado
    IsPaid BIT NOT NULL,
    IsActiveToUpdate BIT NOT NULL DEFAULT 1, -- Si se puede modificar o no
    CreatedAt DATETIME NOT NULL,
    IsDeleted BIT NOT NULL DEFAULT 0,
    CONSTRAINT FK_Booking_Rentable FOREIGN KEY (RentableId) REFERENCES Rentables(RentableId),
);